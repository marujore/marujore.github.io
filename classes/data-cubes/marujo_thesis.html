

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Marujo’s Thesis and Gap-filling &mdash; Rennan Marujo</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  
    <link rel="canonical" href="https://rennan-marujo.github.io/classes/data-cubes/marujo_thesis.html"/>
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Data Cube Initiatives" href="initiatives.html" />
    <link rel="prev" title="Data Cubes" href="intro.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >
          

          
            <a href="../../index.html" class="icon icon-home"> Rennan Marujo
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Rennan Marujo</a></li>
</ul>
<p class="caption"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../general-info/general-info.html">General Information</a></li>
</ul>
<p class="caption"><span class="caption-text">Classes:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../classes.html">Classes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../radiometric-correction/intro.html">Radiometric Correction</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="intro.html">Data Cubes</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Marujo’s Thesis and Gap-filling</a></li>
<li class="toctree-l3"><a class="reference internal" href="initiatives.html">Data Cube Initiatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="bdc.html">Brazil Data Cube</a></li>
<li class="toctree-l3"><a class="reference internal" href="intro.html#references">Referênces</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Publications:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../publications/publications.html">Publications</a></li>
</ul>
<p class="caption"><span class="caption-text">Repositories:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../repositories/repositories.html">Repositories</a></li>
</ul>
<p class="caption"><span class="caption-text">Personal Projects:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../personal-projects/personal-projects.html">Personal Projects</a></li>
</ul>
<p class="caption"><span class="caption-text">Contact:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contact/contact.html">Contact</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Rennan Marujo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../classes.html">Classes</a> &raquo;</li>
        
          <li><a href="intro.html">Data Cubes</a> &raquo;</li>
        
      <li>Marujo’s Thesis and Gap-filling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="initiatives.html" class="btn btn-neutral float-right" title="Data Cube Initiatives" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral float-left" title="Data Cubes" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="marujo-s-thesis-and-gap-filling">
<h1>Marujo’s Thesis and Gap-filling<a class="headerlink" href="#marujo-s-thesis-and-gap-filling" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="#marujo2019"><span class="std std-ref">Gap Filling of Optical Remote Sensing Multi-source data cube through multi-scale and multi-temporal segmentation (MARUJO, 2019)</span></a></p>
<div class="align-center figure align-default" id="fig-study-area">
<a class="reference internal image-reference" href="../../_images/study_area.png"><img alt="Study area." src="../../_images/study_area.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 9 - </span><span class="caption-text">Study areas in Goiás state, Brazil, showing the Landsat and CBERS-4 path/rows.</span><a class="headerlink" href="#fig-study-area" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-dates">
<a class="reference internal image-reference" href="../../_images/dates.png"><img alt="Dates." src="../../_images/dates.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 10 - </span><span class="caption-text">Set of 81 Landsat-8/OLI (L8), 78 Landsat-7/ETM+ (L7) and 37 CBERS-4/MUX (C4) images in blue, green and red lines, respectively, used in the spectral harmonization inorder to build a multi-source data cube (study area 22KEF), ranging from August 2015 to October 2017.</span><a class="headerlink" href="#fig-dates" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-methodology-diagram">
<a class="reference internal image-reference" href="../../_images/methodology_diagram.png"><img alt="Methodology diagram." src="../../_images/methodology_diagram.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 11 - </span><span class="caption-text">Schematic diagram of the adopted methodology to generate multi-source RS image gap-free data cube.</span><a class="headerlink" href="#fig-methodology-diagram" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-lr-diagram">
<a class="reference internal image-reference" href="../../_images/linear_regression_diagram.png"><img alt="Linear Regression diagram." src="../../_images/linear_regression_diagram.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 12 - </span><span class="caption-text">Linear Regression harmonization approach diagram.</span><a class="headerlink" href="#fig-lr-diagram" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-unmixing-diagram">
<a class="reference internal image-reference" href="../../_images/spectral_unmixing_diagram.png"><img alt="Spectral Unmixing diagram." src="../../_images/spectral_unmixing_diagram.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 13 - </span><span class="caption-text">Spectral unmixing harmonization approach diagram.</span><a class="headerlink" href="#fig-unmixing-diagram" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="gap-filling">
<h2>Gap-filling<a class="headerlink" href="#gap-filling" title="Permalink to this headline">¶</a></h2>
<p>The absence of Earth’s surface observations, illustrated in <a class="reference internal" href="#fig-vuolo-gaps"><span class="std std-numref">Figure 14</span></a>, due to cloudpresence, low temporal resolution and sensor defects (e.g. stripe gaps in Landsat-7images) can limit the full exploitation of time series <a class="reference internal" href="#vuolo2017"><span class="std std-ref">VUOLO et al. (2017)</span></a>.</p>
<div class="align-center figure align-default" id="fig-vuolo-gaps">
<a class="reference internal image-reference" href="../../_images/vuolo_gaps.png"><img alt="Gap Types" src="../../_images/vuolo_gaps.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 14 - </span><span class="caption-text">Illustration of the main radiometric problems occurring when working with satellite data. The first image illustrates the presence of clouds, which affects the surface observation by optical sensors. The second image illustrates the Landsat-7/ETM+ Scan Line Corrector (SLC) failure, which implies in stripes of missing data. The third image corresponds to partial images, which occurs on the path/rows borders.Source: Adapted from <a class="reference internal" href="#vuolo2017"><span class="std std-ref">(VUOLO et al., 2017)</span></a>.</span><a class="headerlink" href="#fig-vuolo-gaps" title="Permalink to this image">¶</a></p>
</div>
<p>Landsat-7, one of the most utilized satellites,began to present hardware failure on Enhanced Thematic Plus (ETM+) Scan LineCorrector (SLC) in May 2003, resulting in gaps of valid values, or missing data sections on the acquired images. The images collected before such failures are called SLC-on images, and afterwards they are referred as SLC-off. The gaps correspond to a single pixel near the center of a path/row image and can reach 14 pixels in width near image borders <a class="reference internal" href="#storey2005"><span class="std std-ref">(STOREY et al., 2005)</span></a>, as illustrated in <a class="reference internal" href="#fig-l7-gaps"><span class="std std-numref">Figure 15</span></a>.</p>
<div class="align-center figure align-default" id="fig-l7-gaps">
<a class="reference internal image-reference" href="../../_images/L7_gaps.jpg"><img alt="Landsat-7/ETM+ SLC-off effect image gaps." src="../../_images/L7_gaps.jpg" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 15 - </span><span class="caption-text">A subset of Landsat-7/ETM+ SLC-off image (path/row 220/75).</span><a class="headerlink" href="#fig-l7-gaps" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="maxwell-gap-filling-approach">
<h2>Maxwell Gap-filling Approach<a class="headerlink" href="#maxwell-gap-filling-approach" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#maxwell2004"><span class="std std-ref">Maxwell (2004)</span></a> developed a segmentation approach to fill Landsat-7 SLC-off missing data, pairing it with a reference image that does not contains gaps, based on three principles:</p>
<ul class="simple">
<li><p>Adjacent pixels are more likely to be similar;</p></li>
<li><p>Groups of the same landscape unit are likely to have similar spectral values;</p></li>
<li><p>Most landscapes remain constant for long periods</p></li>
</ul>
<p>This segmentation approach uses a pixel value in its neighboring, delimited by homogeneous regions captured from other close date images <a class="reference internal" href="#maxwell2004"><span class="std std-ref">(MAXWELL, 2004)</span></a>. As can be seen in <a class="reference internal" href="#fig-maxwell2007"><span class="std std-numref">Figure 16</span></a>, <a class="reference internal" href="#maxwell2004"><span class="std std-ref">Maxwell (2004)</span></a> approach fills a target image containing gaps, a Landsat-7/ETM+ SLC-off image, by segmenting a reference image, such as Landsat-5/TM or Landsat-8/OLI acquired in a close date. The reference image is segmented and these segments are overlayed in the target image. For each segment containing a gap on the target image the mode value is calculated and used to fill the missing data, resulting in a synthetic image.</p>
<p>The gap-filling through segmentation has been improved further by using several segmentation levels. <a class="reference internal" href="#maxwell2007"><span class="std std-ref">Maxwell et al. (2007)</span></a> employed three segmentation levels and a nearest neighbor approach in case the third level isn’t enough. In this approach, if a segment is fully contained in the missing data, a segmentation level with segments of a larger area is used to fill the gap <a class="reference internal" href="#maxwell2007"><span class="std std-ref">MAXWELL et al. (2007)</span></a>. This approach is exemplified in <a class="reference internal" href="#fig-maxwell2007"><span class="std std-numref">Figure 16</span></a>.</p>
<div class="align-center figure align-default" id="fig-maxwell2007">
<a class="reference internal image-reference" href="../../_images/maxwell2007.png"><img alt="Multiresolution segmentation approach to fill Landsat-7 SLC-off data." src="../../_images/maxwell2007.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 16 - </span><span class="caption-text">A target image that contains gaps, in this case a Landsat-7/ETM+ SLC-off (a); a reference image, in this case a Landsat-8/OLI acquired in a close date (b); the reference image is segmented (c); the segmentation is overlayed in the target image (d); the mode value within the segment is calculated and used to fill missing data (e); resulted synthetic image (f).</span><a class="headerlink" href="#fig-maxwell2007" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="maxwell-gap-filling-approach-adaptation-with-pixel-weighting">
<h2>Maxwell Gap-filling Approach Adaptation with pixel weighting<a class="headerlink" href="#maxwell-gap-filling-approach-adaptation-with-pixel-weighting" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="#marujo2020"><span class="std std-ref">A multi-scale segmentation approach to filling gaps in landsat ETM+ SLC-off images through pixel weighting (MARUJO et al., 2020)</span></a></p>
<p>The proposed method uses the mean value of the segment instead of the most frequently value (mode) suggested in <a class="reference internal" href="#maxwell2007"><span class="std std-ref">Maxwell et al. (2007)</span></a>, but also maintaining the use of 3 fixed segmentations. In this case, two images are required in the processing: a target image that’s the image with missing observations (gaps) and a reference image acquired in a date close to the target image one. We defined that the acquisition time interval between these images must be less than 9 days, otherwise this gap-filling process is not performed, since the remaining gaps will be filled by the second approach. The <a class="reference internal" href="#baatz2000"><span class="std std-ref">Baatz et al. (2000)</span></a>. algorithm was adopted to generate $3$ levels of segmentation, as in <a class="reference internal" href="#maxwell2007"><span class="std std-ref">Maxwell et al. (2007)</span></a>. Each segmentation level contains segments of different sizes. Levels 1, 2 and 3 contain small, medium and large segments, respectively.</p>
<p>The Gap-filling procedure is illustrated in <a class="reference internal" href="#fig-fill-small-gaps-marujo"><span class="std std-numref">Figure 17</span></a>, in which the gap-filling process is performed using pairs of images, a reference and a target, notwithstanding it is applied to an image data cube. First, reference image is segmented. The segmentation produced in the level 1 is superimposed on both target and reference images. For each segment in the target image that contains gaps the mean value of this segment for both images are calculated. In the reference image, each pixel within the segment is divided by its mean, here called pixel weighting. The pixel weighting means how much this pixel is similar to its segment. Back to the target image, the gaps are filled with target image segment mean weighted by pixel weighting. In a case where all pixel values within a segment are null, the filling process is repeated using the next segmentation level, similarly to <a class="reference internal" href="#maxwell2007"><span class="std std-ref">Maxwell et al. (2007)</span></a>.</p>
<div class="align-center figure align-default" id="fig-fill-small-gaps-marujo">
<a class="reference internal image-reference" href="../../_images/fill_small_gaps_marujo.png"><img alt="Segmentation approach to fill Landsat-7 SLC-off data." src="../../_images/fill_small_gaps_marujo.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 17 - </span><span class="caption-text">Segmentation approach fills Landsat-7 SLC-off gap images: (a) a target image contains gaps, in this case a Landsat-7 SLC-off; (b) a reference image is used, such as Landsat-5 or Landsat-8 acquired in a close date; (c) the reference image is segmented; (d) the sesegments are applied in the reference image; (e) the segment mean value is calculated and used to calculate pixel weights; (f) the segmentation is overlayed in the target image and the mean value within the segment is calculated; (g) for each pixel within the segment, its weight is multiplyed by the segment mean; (h) the gaps are filled with this result; (i) a synthetic image is obtained.</span><a class="headerlink" href="#fig-fill-small-gaps-marujo" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-cube-gaps1">
<a class="reference internal image-reference" href="../../_images/cube_gaps1.png"><img alt="Gap-filling through multiscale segmentation application in a study area." src="../../_images/cube_gaps1.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 18 - </span><span class="caption-text">Visual comparison (NIR band) between SLC-off Landsat-7/ETM+ from 10 August 2015 (superior) and the image filled through the proposed gap-filling approach (inferior)</span><a class="headerlink" href="#fig-cube-gaps1" title="Permalink to this image">¶</a></p>
</div>
<div class="align-center figure align-default" id="fig-gap-comparison">
<a class="reference internal image-reference" href="../../_images/gap_comparison.png"><img alt="Gap-filling SLC-off Landsat-7/ETM+ image through two gap-filling ap-proaches." src="../../_images/gap_comparison.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Figure 19 - </span><span class="caption-text">SLC-off Landsat-7/ETM+ NIR band image (a); NIR band image from “a” filled throughMaxwell et al. (2007) hierarchical multi-scale segmentation method (b) and the same image fromafilled through the proposed method, which uses segmentation pixel weighting(c).</span><a class="headerlink" href="#fig-gap-comparison" title="Permalink to this image">¶</a></p>
</div>
<p>Python implementation (Under Development) <a class="reference external" href="https://github.com/marujore/eofilling.py">https://github.com/marujore/eofilling.py</a></p>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<ul class="simple" id="baatz2000">
<li><p>BAATZ, M., &amp; SCHAPE, A. (2000). Multiresolution segmentation: an optimization approach for high quality multi-scale image segmentation. Angewandte Geographische Informations Verarbeitung, 12, 12–23. Retrieved from <a class="reference external" href="http://www.ecognition.com/sites/default/files/405_baatz_fp_12.pdf">http://www.ecognition.com/sites/default/files/405_baatz_fp_12.pdf</a></p></li>
</ul>
<ul class="simple" id="vuolo2017">
<li><p>VUOLO, F.; NG., W., T.; ATZBERGER, C. (2017). Smoothing and gap-filling of high resolution multi-spectral time series: Example of Landsat data. International Journal of Applied Earth Observation and Geoinformation, 57, 202–213. <a class="reference external" href="https://doi.org/10.1016/j.jag.2016.12.012">https://doi.org/10.1016/j.jag.2016.12.012</a></p></li>
</ul>
<ul class="simple" id="marujo2019">
<li><p>MARUJO, R. F. B. (2019). Gap Filling of Optical Remote Sensing Multi-source data cube through multi-scale and multi-temporal segmentation (National Institute for Space Research (INPE)). Retrieved from <a class="reference external" href="http://urlib.net/rep/8JMKD3MGP3W34R/3SUESRS">http://urlib.net/rep/8JMKD3MGP3W34R/3SUESRS</a></p></li>
</ul>
<ul class="simple" id="marujo2020">
<li><p>MARUJO, R. F. B., FONSECA, L. M. G., KöRTING, T. S.; BENDINI, H. N. (2020). A MULTI-SCALE SEGMENTATION APPROACH TO FILLING GAPS IN LANDSAT ETM+ SLC-OFF IMAGES THROUGH PIXEL WEIGHTING. ISPRS - International Archives of the Photogrammetry, Remote Sensing and Spatial Information Sciences, XLII-3/W11(23), 79–84. <a class="reference external" href="https://doi.org/10.5194/isprs-archives-XLII-3-W11-79-2020">https://doi.org/10.5194/isprs-archives-XLII-3-W11-79-2020</a></p></li>
</ul>
<ul class="simple" id="maxwell2004">
<li><p>MAXWELL, S. (2004). Filling Landsat ETM+ SLC-off Gaps Using a Segmentation Model Approach. Photogrammetric Engineering &amp; Remote Sensing, 70(10), 1109–1111.</p></li>
</ul>
<ul class="simple" id="maxwell2007">
<li><p>MAXWELL, S. K., SCHMIDT, G. L., &amp; STOREY, J. C. (2007). A multi-scale segmentation approach to filling gaps in Landsat ETM+ SLC-off images. International Journal of Remote Sensing, 28(23), 5339–5356. <a class="reference external" href="https://doi.org/10.1080/01431160601034902">https://doi.org/10.1080/01431160601034902</a></p></li>
</ul>
<ul class="simple" id="storey2005">
<li><p>STOREY, J., SCARAMUZZA, P., &amp; SCHMIDT, G. (2005). Landsat 7 Scan Line Corrector-Off Gap-Filled Product Gap-Filled Product Development. Pecora, 16, 23–27.</p></li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="initiatives.html" class="btn btn-neutral float-right" title="Data Cube Initiatives" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro.html" class="btn btn-neutral float-left" title="Data Cubes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Rennan Marujo..

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'XXXXXXXXXX', 'auto');
    
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>